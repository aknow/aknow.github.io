<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="60">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clock</title>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            text-align: center;
            background: white;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
        
        .outer {
            display: inline-table;
            height: 100%;
        }
        
        .inner {
            display: table-cell;
            vertical-align: middle;
        }
        
        .clock {
            font-size: 160px;
        }
        
        .ampm {
            font-size: 64px;
        }
        
        @media (min-width: 1072px) {
            .clock {
                font-size: 240px;
            }
            .ampm {
                font-size: 96px;
            }
        }
        
        .date-row,
        .weather-row {
            margin-top: 40px;
            font-size: 36px;
        }
    </style>
</head>

<body>
    <div class="outer">
        <div class="inner">
            <div class="clock" id="time">--:--</div>
            <div class="ampm" id="ampm">--</div>
            <div id="dateRow" class="date-row"></div>
            <div id="weatherRow" class="weather-row">Loading weather...</div>
        </div>
    </div>

    <script>
        function updateClock() {
            var now = new Date();
            var utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            var pacific = new Date(utc - (7 * 60 * 60000));

            var hours = pacific.getHours();
            var minutes = pacific.getMinutes();
            var ampm = "AM";

            if (hours >= 12) ampm = "PM";
            if (hours > 12) hours -= 12;
            if (hours == 0) hours = 12;

            if (minutes < 10) minutes = "0" + minutes;
            if (hours < 10) hours = "0" + hours;


            var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            var months = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];

            var weekday = days[pacific.getDay()];
            var month = months[pacific.getMonth()];
            var date = pacific.getDate();

            document.getElementById("time").innerText = hours + ":" + minutes;
            document.getElementById("ampm").innerText = ampm;
            document.getElementById("dateRow").innerText = month + " " + date + ", " + weekday;
        }

        function fetchWeather() {
            // Mountain View lat/lon
            var url = "https://api.open-meteo.com/v1/forecast?latitude=37.3861&longitude=-122.0839&current_weather=true";
            fetch(url)
                .then(function(res) {
                    return res.json();
                })
                .then(function(data) {
                    var tempC = data.current_weather.temperature;
                    document.getElementById("weatherRow").innerText = "ðŸŒ¡ï¸ " + tempC.toFixed(1) + "Â°C in Mountain View";
                })
                .catch(function() {
                    document.getElementById("weatherRow").innerText = "Weather unavailable.";
                });
        }

        updateClock();
        fetchWeather();
        setInterval(updateClock, 60000); // Update clock every minute
        setInterval(fetchWeather, 10 * 60 * 1000); // Update weather every 10 minutes

        // updateClock(); // Run once at load
    </script>
</body>

</html>